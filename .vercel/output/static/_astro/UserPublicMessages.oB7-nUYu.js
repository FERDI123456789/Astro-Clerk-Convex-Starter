import{c as O,j as e}from"./createLucideIcon.DJhnDDIa.js";import{r as a}from"./index.DeO6U63H.js";import{w as z,u as L,a as r,b as n,c as E}from"./withConvexClerkProvider.Bgm_kGJw.js";import{t as b}from"./index.CXYkOuos.js";import{U as w,T as c,a as o,S as q,P as y,m as d,b as B,h as F}from"./highLightText.wLjQsNB6.js";import"./chunk-5RWUYJKV.DT1PUBwP.js";import"./index.DrlE4MoQ.js";/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],v=O("message-square",R);function H(){return e.jsxs(d.div,{initial:{opacity:0},animate:{opacity:1},className:"px-6 py-5 animate-pulse flex gap-4 border-b border-gray-100/50",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-100 shrink-0"}),e.jsxs("div",{className:"flex-1 space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-baseline",children:[e.jsx("div",{className:"h-4 w-32 bg-gray-100 rounded"}),e.jsx("div",{className:"h-3.5 w-20 bg-gray-100 rounded"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-4 w-11/12 bg-gray-100 rounded"}),e.jsx("div",{className:"h-4 w-3/4 bg-gray-100 rounded"})]})]})]})}function Q({userId:S}){const t=L(r.messages.listUserPublicMessages,{userId:S}),P=n(r.messages.deleteMessage),k=n(r.messages.togglePin),M=t===void 0,V=t?.[0]?.userName||"User",x=t?.[0]?.userProfilePic||null,U=t?.length||0,C=t?.reduce((s,l)=>s+(l.upVotes??0),0)||0,I=t?.reduce((s,l)=>s+(l.downVotes??0),0)||0,T=t?.reduce((s,l)=>s+(l.downVotes??0)+(l.upVotes??0),0)||0,{isSignedIn:m}=E(),_=n(r.messages.toggleUpvote),$=n(r.messages.toggleDownvote),[i,A]=a.useState(""),[u,h]=a.useState(!1),[f,p]=a.useState(!1),[g,D]=a.useState([]);a.useEffect(()=>{t&&D(t)},[t]);const j=s=>!(i.trim()&&!s.text.toLowerCase().includes(i.toLowerCase())||f&&!s.pinned);let N=g;return u&&(N=[...g].sort((s,l)=>(l.upVotes??0)-(s.upVotes??0))),e.jsxs("div",{className:"max-w-xl mx-auto w-full px-1 sm:px-0 h-full flex flex-col bg-white overflow-hidden",children:[e.jsxs("div",{className:"bg-white ",children:[e.jsxs("div",{className:"px-3 pt-4 pb-2 sm:px-5 sm:pt-6 flex flex-col items-center text-center gap-3",children:[x?e.jsx("img",{src:x,alt:"",className:"w-24 h-24 rounded-full object-cover ring-4 ring-indigo-100"}):e.jsx("div",{className:"w-24 h-24 rounded-full bg-gray-100 flex items-center justify-center ring-4 ring-indigo-100",children:e.jsx(w,{className:"w-10 h-10 text-gray-500"})}),e.jsx("h1",{className:"text-xl font-bold text-gray-900",children:V}),e.jsx("p",{className:"text-sm text-gray-500",children:"Public Messages"})]}),e.jsx("div",{className:"px-2 py-4 w-full",children:e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-2 w-full",children:[e.jsxs("div",{className:"w-full bg-blue-50 p-3 flex flex-col items-center justify-center rounded-xl",children:[e.jsx("div",{className:"gap-2 mb-1 flex flex-row justify-center items-center",children:e.jsx(v,{className:"w-4 h-4 text-blue-600"})}),e.jsx("p",{className:"text-xl font-bold text-blue-600",children:U})]}),e.jsxs("div",{className:"w-full bg-green-50 p-3 flex flex-col items-center justify-center rounded-xl",children:[e.jsx("div",{className:"gap-2 mb-1 flex flex-row justify-center items-center",children:e.jsx(c,{className:"w-4 h-4 text-green-600"})}),e.jsx("p",{className:"text-xl font-bold text-green-600",children:C})]}),e.jsxs("div",{className:"w-full bg-red-50 p-3 flex flex-col items-center justify-center rounded-xl",children:[e.jsx("div",{className:"gap-2 mb-1 flex flex-row justify-center items-center",children:e.jsx(o,{className:"w-4 h-4 text-red-600"})}),e.jsx("p",{className:"text-xl font-bold text-red-600",children:I})]}),e.jsxs("div",{className:"w-full bg-gray-50 p-3 flex flex-col items-center justify-center rounded-xl",children:[e.jsxs("div",{className:"gap-1 mb-1 flex flex-row justify-center items-center",children:[e.jsx(c,{className:"w-4 h-4 text-gray-600"}),e.jsx(o,{className:"w-4 h-4 text-gray-600"})]}),e.jsx("p",{className:"text-xl font-bold text-gray-700",children:T})]})]})})]}),e.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[e.jsxs("div",{className:"sticky top-0 z-10 px-2 pt-2 pb-1 flex flex-wrap items-center gap-2",children:[e.jsx(q,{search:i,setSearch:A,placeholder:"Search for a messageâ€¦"}),e.jsxs("div",{className:"grid grid-cols-2 w-full justify-center items-center gap-2",children:[e.jsxs("button",{onClick:()=>{h(s=>!s),p(!1)},className:`flex justify-center items-center p-3 rounded-md ${u?"bg-green-500 text-white":"shadow-sm hover:bg-green-200 hover:text-green-700"} w-full cursor-pointer transition-all duration-300`,children:[e.jsx(c,{className:"w-5 h-5 mr-3"})," ",e.jsx("span",{className:"hidden sm:flex",children:"Sort by most liked"})]}),e.jsxs("button",{onClick:()=>{p(s=>!s),h(!1)},className:`flex justify-center items-center p-3 rounded-md ${f?"bg-blue-500 text-white":"shadow-sm hover:bg-blue-200 hover:text-blue-700"} w-full cursor-pointer transition-all duration-300`,children:[e.jsx(y,{className:"w-5 h-5 mr-3"})," ",e.jsx("span",{className:"hidden sm:flex",children:"Only pinned messages"})]})]})]}),e.jsx("div",{className:"overflow-y-scroll no-scrollbar",children:M?Array.from({length:8}).map((s,l)=>e.jsx(H,{},l)):t?.length===0?e.jsx("div",{className:"h-full flex flex-col items-center justify-center text-center px-6",children:e.jsxs("div",{className:"max-w-md",children:[e.jsx(v,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),e.jsx("p",{className:"text-2xl font-semibold text-gray-800 mb-2",children:"No public messages yet"}),e.jsx("p",{className:"text-gray-500",children:"This user hasn't posted anything publicly."})]})}):e.jsx(d.div,{layout:"position",className:"flex-1",children:N.map(s=>e.jsx(d.article,{layout:!0,initial:!1,animate:{opacity:j(s)?1:0,height:j(s)?"auto":0},transition:{duration:.15},style:{overflow:"hidden"},children:e.jsx("div",{className:"p-2",children:e.jsxs("div",{className:"flex gap-3 p-3 sm:gap-4 sm:p-4 rounded-xl shadow-sm bg-white",children:[s.userProfilePic?e.jsx("img",{src:s.userProfilePic,alt:"",className:"w-10 h-10 rounded-full object-cover shrink-0 ring-1 ring-gray-200"}):e.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-100 flex items-center justify-center shrink-0 ring-1 ring-gray-200",children:e.jsx(w,{className:"w-5 h-5 text-gray-500"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-1 mb-1.5",children:[e.jsxs("div",{className:"flex gap-x-2 justify-between items-center",children:[e.jsxs("div",{className:"space-x-2",children:[s.userId?e.jsx("a",{href:`/users/${s.userId}/public-messages`,className:"font-medium text-gray-900 hover:text-indigo-700 transition-colors",children:s.userName||"Anonymous"}):e.jsx("span",{className:"font-medium text-gray-900",children:"Anonymous"}),e.jsx("span",{className:"text-sm text-gray-500",children:new Date(s.creationTime).toLocaleDateString([],{month:"short",day:"numeric",hour:"numeric",minute:"2-digit"})})]}),s.userRole==="admin"&&e.jsx("span",{className:"inline-flex items-center rounded-full bg-blue-200 px-2 py-0.5 text-xs font-medium text-blue-700",children:"Admin"})]}),e.jsx("div",{className:"flex justify-center items-center space-x-2",children:s.canDelete?e.jsxs(e.Fragment,{children:[e.jsx("span",{onClick:()=>k({messageId:s._id}),className:`group inline-flex items-center rounded-full cursor-pointer px-2 py-0.5 text-xs font-medium ${s.pinned?"bg-blue-500 text-white":"bg-blue-100 hover:bg-blue-300 text-blue-700"} transition-all duration-300`,children:e.jsx(y,{className:`size-4 ${s.pinned?"rotate-0":"-rotate-32 group-hover:rotate-0"} transition-all duration-300`})}),e.jsx("span",{onClick:()=>P({messageId:s._id}),className:"inline-flex items-center rounded-full cursor-pointer bg-red-100 px-2 py-0.5 text-xs font-medium text-red-700 hover:bg-red-300 transition-all duration-300",children:e.jsx(B,{className:"size-4"})})]}):""})]}),e.jsx("p",{className:"text-gray-800 leading-relaxed wrap-break-words break-all whitespace-pre-wrap",children:F(s.text,i)}),e.jsxs("div",{className:"flex flex-wrap gap-4 mt-3 text-sm",children:[e.jsxs("button",{onClick:()=>{if(!m){b.warning("Sign Up Or Sign In To Vote!");return}_({messageId:s._id})},className:`flex items-center cursor-pointer gap-1.5 transition-colors ${s.upVoted?"text-green-600":"text-gray-500 hover:text-green-600"}`,children:[e.jsx(c,{className:"w-4 h-4"}),e.jsx("span",{children:s.upVotes??0})]}),e.jsxs("button",{onClick:()=>{if(!m){b.warning("Sign Up Or Sign In To Vote!",{});return}$({messageId:s._id})},className:`flex items-center gap-1.5 cursor-pointer transition-colors ${s.downVoted?"text-red-600":"text-gray-500 hover:text-red-600"}`,children:[e.jsx(o,{className:"w-4 h-4"}),e.jsx("span",{children:s.downVotes??0})]})]})]})]})})},s._id))})})]})]})}const ee=z(Q);export{ee as default};
